<!DOCTYPE html>
<html>
<head>
	<title> HOME | AITI-Staff Attendance portal</title>
	<link rel="icon" type="image/png" href="image_and_icon_files/aiti_logo.png">
	<link rel="stylesheet" type="text/css" href="css_files/desktop_css.css">
	<link rel="stylesheet" type="text/css" href="css_files/small_mobile_view.css">
	<link rel="stylesheet" type="text/css" href="css_files/medium_mobile_view.css">
	<link rel="stylesheet" type="text/css" href="css_files/tablet_view.css">
	<link rel="stylesheet" type="text/css" href="css_files/w3.css1.css">
	<script src="javascript_files/jquery-3.4.1.min.js"></script>
</head>
<body>

	<!-- Desktop section -->
	<!-- -------------------------------------------- -->
	<div class="modal" class="w3-blue" style="width: 80%;position: absolute; height: 350px;color:#000!important;background-color:#3f51b5!important;margin-top: 150px;margin-bottom: 100px;margin-left: 8%; border-radius: 5px;animation:animatezoom 0.6s}@keyframes animatezoom{from{transform:scale(0)} to{transform:scale(1)};box-shadow: 2px 3px 3px 6px grey">
		<strong id="shut_admin" style="font-size: 180%;float: right;margin-top: 10px;margin-right: 2%;cursor: pointer; text-align: center;" class="w3-red w3-border w3-border-red">X</strong>
		<form class="w3-container">
			<input type="text" name="adm_id" id="adm" placeholder="Admin ID" style="height: 50px;margin-bottom: 20px;margin-top:20px;width: 100%;border-radius: 3px;outline:none;" class="w3-input"><br>
			<input type="password" name="password" id="adm_pass" placeholder="Password" style="height: 50px;margin-bottom: 20px;width: 100%;border-radius: 5px;outline: none;"><br>
			<button class="w3-btn w3-blue w3-round" class="w3-input" style="width: 20%;margin-left: 40%;height: 50px" id="modal_submit">Login</button><br>
			<span class="w3-text-red" style="font-weight: bold;font-size:110%;display: none;text-align: center;" id="validate_msg">Please enter your ID and password</span>
		</form>
	</div>
	<div class="desktop_main_content">
		<div class="desktop_header">
			<div id="d_AITI_logo">
				<img class="w3-image" src="image_and_icon_files/aiti_logo.png">
			</div>
			<div id="AITI_admin">
				<div id="_admin">
					<strong id="open_admin" class="w3-border w3-display-topright w3-round w3-border-blue w3-blue">Admin Portal</strong>
				</div>
				<form class="w3-container">
					<label><strong>Admin Portal</strong></label>
					<input class="w3-input w3-border" type="text" id="admin_ID" name="ID" placeholder="Staff ID">
					<input class="w3-input w3-border" type="password" id="pass" name="Pass" placeholder="Password">
					<button class="w3-btn w3-blue w3-round" type="submit" id="LogIn">LogIn</button>
					<br>
					<span class="w3-text-red" style="display: none;text-align: left;font-weight: bolder; margin-right:-10%" id="admin_alert">Please Enter your admin ID and password</span>
				</form>
			</div>
		</div>
		<div class="desktop_body" class="w3-container">
			<div id="d_body">
				<span class="w3-panel" style="text-align: center; ">
					<h1 style="font-weight: bolder;font-size: 60px;">WELCOME!</h1>
					<p style="font-size: 28px;"><strong>AITI - KACE</strong> welcomes you to a new day of working experience.<strong>I am your Attendance Log Sheet.</strong></p>
				</span>
				<span id="d_check_form">
					<form class="w3-container">
						<input class="w3-input w3-border" type="text" name="ID" id="staff_ID" placeholder="Staff ID">
						<button class="w3-btn w3-blue w3-round" type="submit" id="Submit">Submit</button>

						<!-- checkIn and checkOut button-->
						<button class="w3-btn w3-rounded w3-red w3-round" id="check_in" style="display: none;" name="checkIn">CheckIn</button>
						<button class="w3-btn w3-rounded w3-red w3-round" id="check_out" style="display: none;">CheckOut</button>
						<br>
						<span class="w3-text-red" style="display: none;text-align: left;font-weight: bolder;margin-right:-10%" id="staff_alert">Please Enter your Staff ID</span>
					</form>
				</span>
			</div>
		</div>
		<div class="desktop_footer">
		</div>
	</div>

	<!-- -------------------------------------------- -->

	<!-- mobile(small and large) and tablet section -->
	<!-- -------------------------------------------- -->
	

	<!-- -------------------------------------------- -->

<script>
	$(document).ready(function(){
		
		
		 /*javascript screen for @media screen (mobile and other devices except desktop)*/
		var media = window.matchMedia("all and (max-width:991px)");
			if(media.matches){
				$("#open_admin").click(function(){
				$("div.modal").fadeIn(4000);
				$("div.desktop_body").slideUp(2000);
			})

				$("#shut_admin").click(function(){
				$("div.modal").fadeOut(4000);
				$("#open_admin").fadeIn();
				$("div.desktop_body").slideDown(2000);
			})

		};

		/* -----------------------------------------------------------------------------------*/
		/*javascript validatiom for the modal pop up*/
		var reg_code = /^(AITI)-[0-9]{8}$/i;
		var pass_code = /^[0-9]{5,10}$/;

		$("#modal_submit").click(function(){
			var admin_id = $("#adm").val();
			var admin_password = $("#adm_pass").val();
			if(admin_id.length == 0 && admin_password.length == 0){
				$("#adm").addClass("w3-border w3-border-red");
				$("#adm_pass").addClass("w3-border w3-border-red");
				$("#validate_msg").show();
				return false
			}
			else if(admin_id.length != 0 && admin_password.length == 0){
				if(!reg_code.test(admin_id)){
					$("#adm").addClass("w3-border-red");
					$("#validate_msg").text("Please enter a valid ID format");
					$("#validate_msg").fadeIn();
					return false
				}
				else if(admin_password.length == 0){
					$("#adm_pass").addClass("w3-border w3-border-red");
					$("#validate_msg").text("Please enter your password");
					$("#validate_msg").fadeIn();
					return false
				}
				else{
					$("#adm").addClass("w3-border w3-border-green");
					$("#adm_pass").addClass("w3-border w3-border-green");
					$("#validate_msg").fadeOut();
					return true
				}
			}
			else if (admin_id.length == 0 && admin_password.length != 0) {
					$("#adm").addClass("w3-border w3-border-red");
					$("#validate_msg").text("Please enter your ID");
					$("#validate_msg").fadeIn();
					return false
			}
			else if(admin_id.length != 0 && admin_password.length != 0){
				if(!reg_code.test(admin_id)){
					$("#adm").addClass("w3-border-red");
					$("#validate_msg").text("Please enter a valid ID format");
					$("#validate_msg").fadeIn();
					return false
				}
				else if(!pass_code.test(admin_password)){
					$("#adm_pass").addClass("w3-border w3-border-red");
					$("#validate_msg").text("Please enter a valid password format, password should contain at least five numerics");
					$("#validate_msg").fadeIn();
					return false
				}
				else{
					$("#validate_msg").fadeOut();
					return true
				}
			}

			else{
					$("#adm").addClass("w3-border-green");
					$("#adm_pass").addClass("w3-border-green");
					$("#validate_msg").fadeOut();
					return true
			}
		})
		$("#adm_pass").keyup(function(){
			var pass_val = $(this).val();
			if(!pass_code.test(pass_val)){
				$("#adm_pass").addClass("w3-border w3-border-red");
				$("#validate_msg").text("Please enter a valid password format, password should contain at least five numerics");
				$("#validate_msg").fadeIn();
				return false
			}
			else{
				$("#adm_pass").removeClass("w3-border w3-border-red");
				$("#adm_pass").addClass("w3-border w3-border-green");
				$("#validate_msg").fadeOut();
				return true
			}
		})
		$("#adm").keyup(function(){
			var adm_val = $(this).val();
			if(!reg_code.test(adm_val)){
				$("#adm").addClass("w3-border w3-border-red");
				$("#validate_msg").text("Please enter a valid ID, eg: AITI-34437657");
				$("#validate_msg").fadeIn();
				return false
			}
			else{
				$("#adm").removeClass("w3-border w3-border-red");
				$("#adm").addClass("w3-border w3-border-green");
				$("#validate_msg").fadeOut();
				return true
			}
		})



		/*________________________________________*/

		/* validating user on the frontEnd */
		


		$("button#LogIn").click(function(){
			var id_val = $("input[name='ID']").val();
			var staff_pass = $("input[name='Pass']").val();
			if (id_val.length == 0 && staff_pass.length == 0) {
				$("#admin_ID").addClass("w3-border-red");
				$("#pass").addClass("w3-border-red");
				$("#admin_alert").fadeIn();
				return false
			}
			else if(id_val.length != 0 && staff_pass.length == 0){
				if (!reg_code.test(id_val)) {
					$("#admin_ID").addClass("w3-border-red");
					$("#admin_alert").text("Please Enter a valid ID, eg: AITI-34437657");
					$("#admin_alert").fadeIn();
					return false
				}else if(staff_pass.length == 0){
					$("#pass").addClass("w3-border-red");
					$("#admin_alert").text("Please Enter your password");
					$("#admin_alert").fadeIn();
					return false
				}
				else{
					$("#admin_ID").removeClass("w3-border-red");
					$("#pass").removeClass("w3-border-red");
					$("#admin_ID").addClass("w3-border-green");
					$("#pass").addClass("w3-border-green");
					$("#admin_alert").fadeOut();
				}

			}
			else if(id_val.length == 0 && staff_pass.length != 0){
				$("#admin_alert").text("Please Enter a valid ID, eg: AITI-34437657");
				$("#admin_alert").fadeIn();
				return false
			}
			else if(id_val.length != 0 && staff_pass.length != 0){
				if (!reg_code.test(id_val)) {
					$("#admin_ID").addClass("w3-border-red");
					$("#admin_alert").text("Please Enter a valid ID, eg: AITI-34437657");
					$("#admin_alert").fadeIn();
					return false
				}
				else if (!pass_code.test(staff_pass)) {
					$("#pass").addClass("w3-border-red");
					$("#admin_alert").text("Please enter a valid password format, password should contain at least five numerics");
					$("#admin_alert").fadeIn();
					return false
				}
				else{
					$("#pass").addClass("w3-border-green");
					$("#admin_ID").removeClass("w3-border-red");
					$("#admin_ID").addClass("w3-border-green");
					$("#admin_alert").fadeOut();
					return true
				}
				
			}
		});

		$("input#admin_ID").keyup(function(){
			var val= $(this).val();
			if (!reg_code.test(val)) {
				$("#admin_ID").addClass("w3-border-red");
				$("#admin_alert").text("Please Enter a valid ID, eg: AITI-34437657");
				$("#admin_alert").fadeIn();
				return false
			}
			else{
				$("#admin_ID").removeClass("w3-border-red");
				$("#admin_ID").addClass("w3-border-green");
				$("#admin_alert").fadeOut();
			}
		});

		$("input#pass").keyup(function(){
			var my_pass = $(this).val();
			if(!pass_code.test(my_pass)){
				$("input#pass").addClass("w3-border-red");
				$("#admin_alert").text("Please enter a valid password format, password should contain at least five numerics");
				$("#admin_alert").fadeIn();
				return false
			}
			else{
				$("#pass").removeClass("w3-border-red");
				$("#pass").addClass("w3-border-green");
				$("#admin_alert").fadeOut();
				return true
			}
		});

		/* validating the staff area*/

		$("button#Submit").click(function(e){
			e.preventDefault();
			//var new_reg = /^(AITI)-[0-9]{8}$/i;
			var staff_id = $("input#staff_ID").val();
			if(staff_id.length == 0){
				$("#staff_ID").addClass("w3-border-red");
				$("#staff_alert").fadeIn();
				return false
			}
			else if(staff_id.length != 0){
				//console.log(staff_id);
				// $.post('php/signin.php',{'ID': staff_id},function(data){
				// 	console.log(data);
				// 	$("button#check_in").show();
				// 	$("button#check_in").click(function(e){
				// 		e.preventDefault();
				// 		$.post('php/checkin.php',function(d){
				// 			console.log(d);
				// 		},'json')
				// 	})
				// },'json');

				$.ajax({
					url: "php/signin.php",
					method: "post",
					data:{'ID': staff_id},
					dataType: 'json',
					success: function(data){
						//console.log(data.message);
						if(data.response == "success"){
							if(!data.checkin){
								$("button#check_in").fadeIn();
							}
							else if(data.checkin && !data.checkout){
								$("button#check_out").fadeIn();
							}
							$("button#Submit").hide();
							if(data.checkout){
								$("span#staff_alert").text(data.message);
								$("span#staff_alert").fadeIn();
							}
						}
						
					},
					error: function(data){
						console.log(data.message);
					}
				})
				
				$("button#check_in").click(function(e){
							e.preventDefault();
					$.ajax({
								url: "php/checkin.php",
								method: "post",
								data:{'ID': staff_id, 'checkIn': '2343'},
								dataType: 'json',
								success: function(data){
									$("button#check_in").fadeOut();
									$("button#check_out").fadeIn();	
									//$("span#staff_alert").text(data.message);
								},
								error: function(data){
									$("span#staff_alert").text(data.message);
									$("span#staff_alert").fadeIn();
								}
							})

						})

						$("button#check_out").click(function(e){
							e.preventDefault();
						$.ajax({
								url: "php/checkout.php",
								method: "post",
								data:{'ID': staff_id, 'checkOut': 'checked'},
								dataType: 'json',
								success: function(data){
									console.log(data.message);
									//$("span#staff_alert").text(data.message);
								},
								error: function(data){
									console.log(data.message);
								}
							})

						})
				return true;
			}
		})
		/* validating with regExp on form feilds*/

		$("input#staff_ID").keyup(function(){
			var reg_val = $(this).val();
			if (!reg_code.test(reg_val)) {
				$("#staff_ID").addClass("w3-border-red");
				$("#staff_alert").text("Please Enter a valid ID, eg: AITI-34437657");
				$("#staff_alert").fadeIn();
			}
			else{
				$("#staff_ID").removeClass("w3-border-red");
				$("#staff_ID").addClass("w3-border-green");
				$("#staff_alert").fadeOut();
			}
		});

		/* ------------------------------------------------------------------------------------ */

	})
</script>
</body>
</html>